<!DOCTYPE html>
<html>
<head>
  <title>RSA Algorithm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<center>
  <h2>RSA Algorithm using HTML & JavaScript</h2>
  <table>
    <tr>
      <td>Prime p:</td>
      <td><input type="number" id="p" value="53"></td>
    </tr>
    <tr>
      <td>Prime q:</td>
      <td><input type="number" id="q" value="59"></td>
    </tr>
    <tr>
      <td>Plaintext (m &lt; n):</td>
      <td><input type="number" id="m" value="89"></td>
    </tr>
    <tr>
      <td>n = p × q:</td>
      <td><span id="n"></span></td>
    </tr>
    <tr>
      <td>φ(n):</td>
      <td><span id="phi"></span></td>
    </tr>
    <tr>
      <td>Public exponent e:</td>
      <td><span id="e"></span></td>
    </tr>
    <tr>
      <td>Private key d:</td>
      <td><span id="d"></span></td>
    </tr>
    <tr>
      <td>Ciphertext (c):</td>
      <td><span id="c"></span></td>
    </tr>
    <tr>
      <td>Decrypted m:</td>
      <td><span id="dec"></span></td>
    </tr>
    <tr>
      <td colspan="2" style="text-align:center;">
        <button onclick="rsa()">Run RSA</button>
      </td>
    </tr>
  </table>
</center>

<script>
  function gcd(a, b) {
    return b === 0 ? a : gcd(b, a % b);
  }

  // very simple (slow but easy) modular exponentiation
  function powMod(base, exp, mod) {
    let r = 1;
    for (let i = 0; i < exp; i++) r = (r * base) % mod;
    return r;
  }

  function rsa() {
    const p = parseInt(document.getElementById("p").value);
    const q = parseInt(document.getElementById("q").value);
    const m = parseInt(document.getElementById("m").value);

    const n = p * q;
    const phi = (p - 1) * (q - 1);

    // choose smallest e that is coprime with phi
    let e = 2;
    while (e < phi && gcd(e, phi) !== 1) e++;

    // find d such that (d * e) % phi == 1
    let d = 1;
    while ((d * e) % phi !== 1) d++;

    const c = powMod(m, e, n);   // encryption: c = m^e mod n
    const dec = powMod(c, d, n); // decryption: m = c^d mod n

    document.getElementById("n").textContent = n;
    document.getElementById("phi").textContent = phi;
    document.getElementById("e").textContent = e;
    document.getElementById("d").textContent = d;
    document.getElementById("c").textContent = c;
    document.getElementById("dec").textContent = dec;
  }
</script>
</body>
</html>
